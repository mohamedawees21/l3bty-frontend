{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\HP\\\\OneDrive\\\\project\\\\l3bty-rental-system\\\\frontend\\\\src\\\\components\\\\ProtectedRoute.jsx\",\n  _s = $RefreshSig$();\n// src/components/ProtectedRoute.jsx\nimport React, { useEffect } from 'react';\nimport { Navigate, useLocation } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport { toast } from 'react-toastify';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProtectedRoute = ({\n  children,\n  requiredRole,\n  allowedRoles = [],\n  requiredPermissions = [],\n  redirectTo = '/unauthorized'\n}) => {\n  _s();\n  const {\n    user,\n    isAuthenticated,\n    loading,\n    hasPermission\n  } = useAuth();\n  const location = useLocation();\n  useEffect(() => {\n    if (!loading && !isAuthenticated) {\n      toast.error('ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู ูููุตูู ููุฐู ุงูุตูุญุฉ');\n    }\n  }, [loading, isAuthenticated]);\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center min-h-screen\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 26,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 25,\n      columnNumber: 7\n    }, this);\n  }\n  if (!isAuthenticated || !user) {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\",\n      state: {\n        from: location.pathname\n      },\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 12\n    }, this);\n  }\n\n  // ๐ฅ ุงูุชุญูู ูู ุงูุฏูุฑ ุงููุทููุจ\n  if (requiredRole && user.role !== requiredRole) {\n    toast.error(`ูุฐู ุงูุตูุญุฉ ุฎุงุตุฉ ุจู ${requiredRole === 'admin' ? 'ุงููุดุฑููู' : 'ุงููุณุคูููู'}`);\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: redirectTo,\n      state: {\n        requiredRole,\n        currentRole: user.role\n      },\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 12\n    }, this);\n  }\n\n  // ๐ฅ ุงูุชุญูู ูู ุงูุฃุฏูุงุฑ ุงููุณููุญุฉ\n  if (allowedRoles.length > 0 && !allowedRoles.includes(user.role)) {\n    toast.error('ุบูุฑ ูุตุฑุญ ูู ุจุงููุตูู ููุฐู ุงูุตูุญุฉ');\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: redirectTo,\n      state: {\n        allowedRoles,\n        currentRole: user.role\n      },\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 12\n    }, this);\n  }\n\n  // ๐ฅ ุงูุชุญูู ูู ุงูุตูุงุญูุงุช ุงููุทููุจุฉ\n  if (requiredPermissions.length > 0) {\n    const hasAllPermissions = requiredPermissions.every(permission => hasPermission(permission));\n    if (!hasAllPermissions) {\n      toast.error('ููุณ ูุฏูู ุงูุตูุงุญูุงุช ุงููุงููุฉ ูููุตูู ููุฐู ุงูุตูุญุฉ');\n      return /*#__PURE__*/_jsxDEV(Navigate, {\n        to: redirectTo,\n        state: {\n          requiredPermissions\n        },\n        replace: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 14\n      }, this);\n    }\n  }\n\n  // ๐ฅ ุงูุชุญูู ูู ุฃู ุงูููุธู ูุฏูู ุดููุช ูุดุท ูุจุนุถ ุงูุตูุญุงุช\n  if (user.role === 'employee' && location.pathname.includes('/employee/rentals')) {\n    const hasActiveShift = localStorage.getItem('active_shift_id');\n    if (!hasActiveShift && location.pathname !== '/employee/shift/start') {\n      toast.info('ูุฌุจ ุจุฏุก ุดููุช ุฃููุงู');\n      return /*#__PURE__*/_jsxDEV(Navigate, {\n        to: \"/employee/shift/start\",\n        replace: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 14\n      }, this);\n    }\n  }\n  return children;\n};\n_s(ProtectedRoute, \"k9owOR6mleS4e0CPzAaacP+HEkk=\", false, function () {\n  return [useAuth, useLocation];\n});\n_c = ProtectedRoute;\nexport default ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["React","useEffect","Navigate","useLocation","useAuth","toast","jsxDEV","_jsxDEV","ProtectedRoute","children","requiredRole","allowedRoles","requiredPermissions","redirectTo","_s","user","isAuthenticated","loading","hasPermission","location","error","className","fileName","_jsxFileName","lineNumber","columnNumber","to","state","from","pathname","replace","role","currentRole","length","includes","hasAllPermissions","every","permission","hasActiveShift","localStorage","getItem","info","_c","$RefreshReg$"],"sources":["C:/Users/HP/OneDrive/project/l3bty-rental-system/frontend/src/components/ProtectedRoute.jsx"],"sourcesContent":["// src/components/ProtectedRoute.jsx\r\nimport React, { useEffect } from 'react';\r\nimport { Navigate, useLocation } from 'react-router-dom';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { toast } from 'react-toastify';\r\n\r\nconst ProtectedRoute = ({ \r\n  children, \r\n  requiredRole, \r\n  allowedRoles = [], \r\n  requiredPermissions = [],\r\n  redirectTo = '/unauthorized'\r\n}) => {\r\n  const { user, isAuthenticated, loading, hasPermission } = useAuth();\r\n  const location = useLocation();\r\n  \r\n  useEffect(() => {\r\n    if (!loading && !isAuthenticated) {\r\n      toast.error('ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู ูููุตูู ููุฐู ุงูุตูุญุฉ');\r\n    }\r\n  }, [loading, isAuthenticated]);\r\n  \r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500\"></div>\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  if (!isAuthenticated || !user) {\r\n    return <Navigate to=\"/login\" state={{ from: location.pathname }} replace />;\r\n  }\r\n  \r\n  // ๐ฅ ุงูุชุญูู ูู ุงูุฏูุฑ ุงููุทููุจ\r\n  if (requiredRole && user.role !== requiredRole) {\r\n    toast.error(`ูุฐู ุงูุตูุญุฉ ุฎุงุตุฉ ุจู ${requiredRole === 'admin' ? 'ุงููุดุฑููู' : 'ุงููุณุคูููู'}`);\r\n    return <Navigate to={redirectTo} state={{ requiredRole, currentRole: user.role }} replace />;\r\n  }\r\n  \r\n  // ๐ฅ ุงูุชุญูู ูู ุงูุฃุฏูุงุฑ ุงููุณููุญุฉ\r\n  if (allowedRoles.length > 0 && !allowedRoles.includes(user.role)) {\r\n    toast.error('ุบูุฑ ูุตุฑุญ ูู ุจุงููุตูู ููุฐู ุงูุตูุญุฉ');\r\n    return <Navigate to={redirectTo} state={{ allowedRoles, currentRole: user.role }} replace />;\r\n  }\r\n  \r\n  // ๐ฅ ุงูุชุญูู ูู ุงูุตูุงุญูุงุช ุงููุทููุจุฉ\r\n  if (requiredPermissions.length > 0) {\r\n    const hasAllPermissions = requiredPermissions.every(permission => \r\n      hasPermission(permission)\r\n    );\r\n    \r\n    if (!hasAllPermissions) {\r\n      toast.error('ููุณ ูุฏูู ุงูุตูุงุญูุงุช ุงููุงููุฉ ูููุตูู ููุฐู ุงูุตูุญุฉ');\r\n      return <Navigate to={redirectTo} state={{ requiredPermissions }} replace />;\r\n    }\r\n  }\r\n  \r\n  // ๐ฅ ุงูุชุญูู ูู ุฃู ุงูููุธู ูุฏูู ุดููุช ูุดุท ูุจุนุถ ุงูุตูุญุงุช\r\n  if (user.role === 'employee' && location.pathname.includes('/employee/rentals')) {\r\n    const hasActiveShift = localStorage.getItem('active_shift_id');\r\n    if (!hasActiveShift && location.pathname !== '/employee/shift/start') {\r\n      toast.info('ูุฌุจ ุจุฏุก ุดููุช ุฃููุงู');\r\n      return <Navigate to=\"/employee/shift/start\" replace />;\r\n    }\r\n  }\r\n  \r\n  return children;\r\n};\r\n\r\nexport default ProtectedRoute;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}