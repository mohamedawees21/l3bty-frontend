{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\HP\\\\OneDrive\\\\project\\\\l3bty-rental-system\\\\frontend\\\\src\\\\components\\\\ProtectedRoute.jsx\",\n  _s = $RefreshSig$();\n// src/components/ProtectedRoute.jsx\nimport React from 'react';\nimport { Navigate, useLocation } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProtectedRoute = ({\n  children,\n  roles = [],\n  permissions = []\n}) => {\n  _s();\n  const {\n    user,\n    isAuthenticated,\n    loading,\n    authChecked\n  } = useAuth();\n  const location = useLocation();\n  if (loading || !authChecked) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center min-h-screen\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 14,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-4 text-gray-600\",\n          children: \"\\u062C\\u0627\\u0631\\u064A \\u0627\\u0644\\u062A\\u062D\\u0642\\u0642 \\u0645\\u0646 \\u0627\\u0644\\u0635\\u0644\\u0627\\u062D\\u064A\\u0627\\u062A...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 15,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 13,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 12,\n      columnNumber: 7\n    }, this);\n  }\n  if (!isAuthenticated || !user) {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\",\n      state: {\n        from: location.pathname\n      },\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 22,\n      columnNumber: 12\n    }, this);\n  }\n\n  // ðŸ”¥ **Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø¯ÙˆØ§Ø±**\n  if (roles.length > 0 && !roles.includes(user.role)) {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/unauthorized\",\n      state: {\n        from: location.pathname,\n        requiredRole: roles,\n        currentRole: user.role\n      },\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 7\n    }, this);\n  }\n\n  // ðŸ”¥ **Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)**\n  if (permissions.length > 0) {\n    const hasAllPermissions = permissions.every(permission => {\n      var _user$permissions;\n      return (_user$permissions = user.permissions) === null || _user$permissions === void 0 ? void 0 : _user$permissions.includes(permission);\n    });\n    if (!hasAllPermissions) {\n      return /*#__PURE__*/_jsxDEV(Navigate, {\n        to: \"/forbidden\",\n        state: {\n          from: location.pathname,\n          requiredPermissions: permissions\n        },\n        replace: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }, this);\n    }\n  }\n  return children;\n};\n_s(ProtectedRoute, \"CuD+MP7fuitW1L5j4BZPFm+srcA=\", false, function () {\n  return [useAuth, useLocation];\n});\n_c = ProtectedRoute;\nexport default ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["React","Navigate","useLocation","useAuth","jsxDEV","_jsxDEV","ProtectedRoute","children","roles","permissions","_s","user","isAuthenticated","loading","authChecked","location","className","fileName","_jsxFileName","lineNumber","columnNumber","to","state","from","pathname","replace","length","includes","role","requiredRole","currentRole","hasAllPermissions","every","permission","_user$permissions","requiredPermissions","_c","$RefreshReg$"],"sources":["C:/Users/HP/OneDrive/project/l3bty-rental-system/frontend/src/components/ProtectedRoute.jsx"],"sourcesContent":["// src/components/ProtectedRoute.jsx\r\nimport React from 'react';\r\nimport { Navigate, useLocation } from 'react-router-dom';\r\nimport { useAuth } from '../context/AuthContext';\r\n\r\nconst ProtectedRoute = ({ children, roles = [], permissions = [] }) => {\r\n  const { user, isAuthenticated, loading, authChecked } = useAuth();\r\n  const location = useLocation();\r\n\r\n  if (loading || !authChecked) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto\"></div>\r\n          <p className=\"mt-4 text-gray-600\">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!isAuthenticated || !user) {\r\n    return <Navigate to=\"/login\" state={{ from: location.pathname }} replace />;\r\n  }\r\n\r\n  // ðŸ”¥ **Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø¯ÙˆØ§Ø±**\r\n  if (roles.length > 0 && !roles.includes(user.role)) {\r\n    return (\r\n      <Navigate \r\n        to=\"/unauthorized\" \r\n        state={{ \r\n          from: location.pathname,\r\n          requiredRole: roles,\r\n          currentRole: user.role\r\n        }} \r\n        replace \r\n      />\r\n    );\r\n  }\r\n\r\n  // ðŸ”¥ **Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)**\r\n  if (permissions.length > 0) {\r\n    const hasAllPermissions = permissions.every(permission => \r\n      user.permissions?.includes(permission)\r\n    );\r\n    \r\n    if (!hasAllPermissions) {\r\n      return (\r\n        <Navigate \r\n          to=\"/forbidden\" \r\n          state={{ \r\n            from: location.pathname,\r\n            requiredPermissions: permissions\r\n          }} \r\n          replace \r\n        />\r\n      );\r\n    }\r\n  }\r\n\r\n  return children;\r\n};\r\n\r\nexport default ProtectedRoute;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}